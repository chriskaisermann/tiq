!function(){var e=function(e){return"function"==typeof e},t=function(t,o){if(!e(o))throw"Tiq: Invalid callback";return this[t]=o,this},o=function(e){this.queue=e||[],this.reset()};o.prototype.add=function(t,o,r){var a=this;if(r=r||1,!e(o))throw"Tiq: Invalid callback";for(;r--;)a.queue.push([t,o]);return this},o.prototype.run=function(){var e=this;return this.playing=!0,this.beforeCallback&&!this.hasExecutedBeforeCallback&&(this.hasExecutedBeforeCallback=!0,this.beforeCallback.call(this)),this.timer=setTimeout(function t(){if(!e.playing)return e.stop();0===e.currentIndex&&1!==e.numberOfLoops&&e.beforeLoopCallback&&e.beforeLoopCallback.call(e,e);var o=e.queue[e.currentIndex][1];if(e.lastCallback===o?e.sameMethodCounter++:e.sameMethodCounter=0,e.executionCounter++,o&&o.call(e,e),e.eachCallback&&e.eachCallback.call(e,e),e.currentIndex+1===e.queue.length){if(1!==e.numberOfLoops&&e.afterLoopCallback&&e.afterLoopCallback.call(e,e),++e.currentLoopIndex>=e.numberOfLoops)return e.afterCallback&&e.afterCallback.call(e,e),e.stop();e.lastCallback=null,e.currentIndex=-1}else e.lastCallback=o;e.timer=setTimeout(t,e.queue[++e.currentIndex][0])},e.queue[e.currentIndex][0]),this},o.prototype.stop=function(){return this.playing=!1,clearTimeout(this.timer),this.timer=null,this},o.prototype.loop=function(e){return this.numberOfLoops=e||-1,this},o.prototype.repeat=function(e,t,o){return this.add(t,o,e)},o.prototype.reset=function(){return this.stop(),this.numberOfLoops=1,this.currentIndex=0,this.currentLoopIndex=0,this.sameMethodCounter=0,this.executionCounter=0,this.lastCallback=null,this.hasExecutedBeforeCallback=!1,this},["beforeLoop","afterLoop","each","before","after"].forEach(function(e){o.prototype[e]=function(o){return t.call(this,e+"Callback",o)}}),module&&module.exports?module.exports=o:window.Tiq=o}();